import pandas as pd
import streamlit as st 
from PIL import Image

st.set_page_config(
    layout="wide",
    page_title="Solicita칞칚o Resson칙ncia Magn칠tica SMS RJ",
    page_icon="游븷"
)

image_button_aprov = Image.open('.venv/button_apr.png')
image_button_neg = Image.open('.venv/button_neg.png')
image_button_pend = Image.open('.venv/button_pend.png')
image = Image.open('.venv/banner.png')

st.image(image, caption=None, output_format="JPEG")



# Initialize session state
if 'show_patient_data' not in st.session_state:
    st.session_state.show_patient_data = False

if 'show_request_form' not in st.session_state:
    st.session_state.show_request_form = False

def main():
    # INPUT CALCULADORA
    with st.form(key='calculator_form'):
        # Ingresa el valor
        cpf_paciente = st.text_input("CPF/CNS")
        nome_paciente = st.text_input("Nome do Usu치rio")
        nome_mae_paciente = st.text_input("Nome da M칚e")
        submit_button = st.form_submit_button(label='Pesquisar', use_container_width=True)

    if submit_button:
        st.session_state.show_patient_data = True

    if st.session_state.show_patient_data:
        st.markdown("<h1 style='text-align: center; color: black;'>Dados do Paciente </h1>", unsafe_allow_html=True)
        #st.title("Dados do Paciente")
        st.write("CNS: xxxxxxxxxxx")
        st.write("Nome: xxxxxxxxxxx")
        st.write("Nome da M칚e: xxxxxxxxxxx")
        st.write("Sexo: xxxxxxxxxxx")
        st.write("Data de Nascimento: xxxxxxxxxxx")

        if st.button("Iniciar Solicita칞칚o", type="primary"):
            st.session_state.show_request_form = True

    if st.session_state.show_request_form:
        st.markdown("<h1 style='text-align: center; color: black;'>Informa칞칫es de Solicita칞칚o</h1>", unsafe_allow_html=True)
        #st.title("Informa칞칫es de Solicita칞칚o")

        cid_paciente = st.text_input("Qual o CID suspeito?")

        options_purpose = ['Follow up / acompanhamento', 'Rastreamento', 'Suspeita', 'Estadiamento', 'Esclarecer diagn칩stico']
        purpose = st.selectbox('Qual a finalidade da solicita칞칚o desse exame?', [''] + options_purpose)

        # Function to handle purpose selection
        if purpose == 'Follow up / acompanhamento':
            display_follow_up_options()
        elif purpose == 'Rastreamento':
            display_screening_options()
        elif purpose == 'Suspeita':
            display_suspect_options()
        elif purpose == 'Estadiamento':
            display_staging_options()
        elif purpose == 'Esclarecer diagn칩stico':
            display_diagnostic_options()

def display_follow_up_options():
    options_follow_up = ['C칙ncer Renal', 'C칙ncer Pr칩stata', 'C칙ncer Bexiga', 'C칙ncer Test칤culo', 'Tumor osso prim치rio em ossos do quadril', 'Outra']
    follow_up = st.selectbox('Tipo de acompanhamento:', [''] + options_follow_up)
    
    if follow_up in ['C칙ncer Renal', 'C칙ncer Pr칩stata', 'C칙ncer Bexiga', 'C칙ncer Test칤culo', 'Tumor osso prim치rio em ossos do quadril']:
        #st.write("Aprovado")
        st.image(image_button_aprov, caption=None, output_format="JPEG")
    elif follow_up == 'Outra':
        #st.write("Negado")
        st.image(image_button_neg, caption=None, output_format="JPEG")
        

def display_staging_options():
    options_staging = ['C칙ncer Coloretal', 'C칙ncer de Ov치rio', 'C칙ncer de Vagina', 'C칙ncer na Vulva', 'Doen칞a Trofobl치stica Gestacional', 'Outra']
    staging = st.selectbox('Tipo de estadiamento:', [''] + options_staging)
    
    if staging == 'C칙ncer Coloretal':
        display_colorectal_options()
    elif staging == 'C칙ncer de Ov치rio':
        display_ovarian_options()
    elif staging == 'C칙ncer de Vagina':
        display_vaginal_options()
    elif staging == 'C칙ncer na Vulva':
        display_vulvar_options()
    elif staging == 'Doen칞a Trofobl치stica Gestacional':
        display_gtg_options()
    elif staging == 'Outra':
        #st.write("Negado")
        st.image(image_button_neg, caption=None, output_format="JPEG")

def display_colorectal_options():
    confirmed_diagnosis = st.selectbox('Paciente tem diagn칩stico confirmado?', ['', 'Sim', 'N칚o'])
    
    if confirmed_diagnosis == 'Sim':
        neoadjuvant = st.selectbox('Realizou QT neoadjuvante?', ['', 'Sim', 'N칚o'])
        if neoadjuvant == 'Sim':
            #st.write("Aprovado")
            st.image(image_button_aprov, caption=None, output_format="JPEG")

        elif neoadjuvant == 'N칚o':
            #st.write("Negado")
            st.image(image_button_neg, caption=None, output_format="JPEG")
    elif confirmed_diagnosis == 'N칚o':
        #st.write("Negado")
        st.image(image_button_neg, caption=None, output_format="JPEG")

def display_ovarian_options():
    treatment = st.selectbox('J치 realizou tratamento?', ['', 'Sim', 'N칚o'])
    
    if treatment == 'Sim':
        recurrence = st.selectbox('Suspeita de recidiva?', ['', 'Sim', 'N칚o'])
        if recurrence == 'Sim':
            #st.write("Aprovado")
            st.image(image_button_aprov, caption=None, output_format="JPEG")

        elif recurrence == 'N칚o':
            #st.write("Negado")
            st.image(image_button_neg, caption=None, output_format="JPEG")
    elif treatment == 'N칚o':
        #st.write("Aprovado")
        st.image(image_button_aprov, caption=None, output_format="JPEG")


def display_vaginal_options():
    treatment = st.selectbox('J치 realizou tratamento?', ['', 'Sim', 'N칚o'])
    
    if treatment == 'Sim':
        recurrence = st.selectbox('Suspeita de recidiva?', ['', 'Sim', 'N칚o'])
        if recurrence == 'Sim':
            #st.write("Aprovado")
            st.image(image_button_aprov, caption=None, output_format="JPEG")

        elif recurrence == 'N칚o':
            #st.write("Negado")
            st.image(image_button_neg, caption=None, output_format="JPEG")
    elif treatment == 'N칚o':
        #st.write("Aprovado")
        st.image(image_button_aprov, caption=None, output_format="JPEG")


def display_vulvar_options():
    treatment = st.selectbox('J치 realizou tratamento?', ['', 'Sim', 'N칚o'])
    
    if treatment == 'Sim':
        recurrence = st.selectbox('Suspeita de recidiva?', ['', 'Sim', 'N칚o'])
        if recurrence == 'Sim':
            #st.write("Aprovado")
            st.image(image_button_aprov, caption=None, output_format="JPEG")

        elif recurrence == 'N칚o':
            #st.write("Negado")
            st.image(image_button_neg, caption=None, output_format="JPEG")
    elif treatment == 'N칚o':
        #st.write("Aprovado")
        st.image(image_button_aprov, caption=None, output_format="JPEG")


def display_gtg_options():
    confirmed_diagnosis = st.selectbox('Diagn칩stico confirmado?', ['', 'Sim', 'N칚o'])
    
    if confirmed_diagnosis == 'Sim':
        #st.write("Aprovado")
        st.image(image_button_aprov, caption=None, output_format="JPEG")

    elif confirmed_diagnosis == 'N칚o':
        #st.write("Negado")
        st.image(image_button_neg, caption=None, output_format="JPEG")

def display_screening_options():
    options_screening = ['C칙ncer Coloretal', 'C칙ncer de Ov치rio', 'C칙ncer de 칔tero', 'C칙ncer de Trompas', 'C칙ncer Bexiga', 'C칙ncer de Ureteres', 'C칙ncer de Rins', 'Outra']
    screening = st.selectbox('Tipo de rastreamento:', [''] + options_screening)
    
    if screening:
        #st.write("Negado")
        st.image(image_button_neg, caption=None, output_format="JPEG")

def display_suspect_options():
    st.write("N칚o aprovado - Crit칠rios n칚o preenchidos para suspeita")

def display_diagnostic_options():
    alteration_exam = st.selectbox('Queixas ou altera칞칚o no exame f칤sico?', ['','Sim, Quais?', 'N칚o possui', 'N칚o avaliado'])
    
    if alteration_exam == 'Sim, Quais?':
        body_part = st.selectbox('Qual parte do corpo?', ['','Cabe칞a e pesco칞o', 'Aparelho respirat칩rio', 'Aparelho cardiovascular', 'Abdome', 'Aparelho geniturin치rio'])
        
        if body_part in ['Cabe칞a e pesco칞o', 'Aparelho respirat칩rio', 'Aparelho cardiovascular']:
            #st.write("Negado")
            st.image(image_button_neg, caption=None, output_format="JPEG")
        elif body_part == 'Abdome':
            abdomen_condition = st.selectbox('Qual condi칞칚o?', ['','Massa abdominal palp치vel', 'Dor abdominal', 'H칠rnia'])
            
            if abdomen_condition == 'Massa abdominal palp치vel':
                tc_pelvis = st.selectbox('Realizou TC pr칠via?', ['','Sim', 'N칚o'])
                if tc_pelvis == 'Sim':
                    tc_result = st.selectbox('Resultado foi esclarecedor?', ['','Sim', 'N칚o'])
                    if tc_result == 'Sim':
                        #st.write("Negado")
                        st.image(image_button_neg, caption=None, output_format="JPEG")
                    elif tc_result == 'N칚o':
                        topography = st.selectbox('Qual topografia?', ['','Quadrante inferior direito', 'Quadrante inferior esquerdo', 'Hipog치strio inferior/esquerdo/al칞a'])
                        if topography in ['Quadrante inferior direito', 'Quadrante inferior esquerdo']:
                            #st.write("Aprovado")
                            st.image(image_button_aprov, caption=None, output_format="JPEG")

                        elif topography == 'Hipog치strio inferior/esquerdo/al칞a':
                            #st.write("Aprovado")
                            st.image(image_button_aprov, caption=None, output_format="JPEG")

                elif tc_pelvis == 'N칚o':
                    #st.write("Negado")
                    st.image(image_button_neg, caption=None, output_format="JPEG")
            elif abdomen_condition == 'Dor abdominal':
                evolution_time = st.selectbox('Qual tempo de evolu칞칚o?', ['','Aguda', 'Cr칪nica'])
                if evolution_time == 'Aguda':
                    alteration_lab = st.selectbox('Possui altera칞칚o no exame laboratorial de neutr칩filos?', ['','Sim', 'N칚o'])
                    if alteration_lab == 'Sim':
                        #st.write("Aprovado")
                        st.image(image_button_aprov, caption=None, output_format="JPEG")

                    elif alteration_lab == 'N칚o':
                        tc_pelvis = st.selectbox('Realizou TC pr칠via?', ['','Sim', 'N칚o'])
                        if tc_pelvis == 'Sim':
                            tc_result = st.selectbox('Resultado foi esclarecedor?', ['','Sim', 'N칚o'])
                            if tc_result == 'Sim':
                                #st.write("Negado")
                                st.image(image_button_neg, caption=None, output_format="JPEG")
                            elif tc_result == 'N칚o':
                                #st.write("Aprovado")
                                st.image(image_button_aprov, caption=None, output_format="JPEG")

                        elif tc_pelvis == 'N칚o':
                            #st.write("Negado")
                            st.image(image_button_neg, caption=None, output_format="JPEG")
                elif evolution_time == 'Cr칪nica':
                    #st.write("Negado")
                    st.image(image_button_neg, caption=None, output_format="JPEG")
            elif abdomen_condition == 'H칠rnia':
                hernia_confirmed = st.selectbox('Diagn칩stico confirmado?', ['','Sim', 'N칚o'])
                if hernia_confirmed == 'Sim':
                    pre_op = st.selectbox('칄 necess치ria para preparo pr칠-operat칩rio?', ['','Sim', 'N칚o'])
                    if pre_op == 'Sim':
                        #st.write("Aprovado")
                        st.image(image_button_aprov, caption=None, output_format="JPEG")

                    elif pre_op == 'N칚o':
                        st.write("Negado")
                        #st.image(image_button_neg, caption=None, output_format="JPEG")
                elif hernia_confirmed == 'N칚o':
                    #st.write("Negado")
                    st.image(image_button_neg, caption=None, output_format="JPEG")
        elif body_part == 'Aparelho geniturin치rio':
            genitourinary_condition = st.selectbox('Qual condi칞칚o?', ['','Prolapso urogenital', 'Hemat칰ria', 'Sangramento uterina anormal', 'Dor p칠lvica'])
            
            if genitourinary_condition == 'Prolapso urogenital':
                #st.write("Negado")
                st.image(image_button_neg, caption=None, output_format="JPEG")
            elif genitourinary_condition == 'Hemat칰ria':
                usg_tc = st.selectbox('Realizou USG ou TC pr칠via?', ['','Sim', 'N칚o'])
                if usg_tc == 'Sim':
                    usg_tc_result = st.selectbox('Resultado foi esclarecedor?', ['','Sim', 'N칚o'])
                    if usg_tc_result == 'Sim':
                        #st.write("Negado")
                        st.image(image_button_neg, caption=None, output_format="JPEG")
                    elif usg_tc_result == 'N칚o':
                        #st.write("Aprovado")
                        st.image(image_button_aprov, caption=None, output_format="JPEG")

                elif usg_tc == 'N칚o':
                    #st.write("Negado")
                    st.image(image_button_neg, caption=None, output_format="JPEG")
            elif genitourinary_condition == 'Sangramento uterina anormal':
                pregnant = st.selectbox('Gestante?', ['','Sim', 'N칚o'])
                if pregnant == 'Sim':
                    usg = st.selectbox('Realizou USG pr칠via?', ['','Sim', 'N칚o'])
                    if usg == 'Sim':
                        usg_result = st.selectbox('Resultado foi esclarecedor?', ['','Sim', 'N칚o'])
                        if usg_result == 'Sim':
                            #st.write("Negado")
                            st.image(image_button_neg, caption=None, output_format="JPEG")
                        elif usg_result == 'N칚o':
                            #st.write("Aprovado")
                            st.image(image_button_aprov, caption=None, output_format="JPEG")

                    elif usg == 'N칚o':
                        #st.write("Negado")
                        st.image(image_button_neg, caption=None, output_format="JPEG")
                elif pregnant == 'N칚o':
                    #st.write("Negado")
                    st.image(image_button_neg, caption=None, output_format="JPEG")
            elif genitourinary_condition == 'Dor p칠lvica':
                pelvic_pain_time = st.selectbox('Qual tempo de evolu칞칚o?', ['','Aguda', 'Cr칪nica'])
                if pelvic_pain_time == 'Aguda':
                    usg = st.selectbox('Realizou USG pr칠via?', ['','Sim', 'N칚o'])
                    if usg == 'Sim':
                        usg_result = st.selectbox('Resultado foi esclarecedor?', ['','Sim', 'N칚o'])
                        if usg_result == 'Sim':
                            #st.write("Negado")
                            st.image(image_button_neg, caption=None, output_format="JPEG")
                        elif usg_result == 'N칚o':
                            #st.write("Aprovado")
                            st.image(image_button_aprov, caption=None, output_format="JPEG")

                    elif usg == 'N칚o':
                        #st.write("Negado")
                        st.image(image_button_neg, caption=None, output_format="JPEG")
                elif pelvic_pain_time == 'Cr칪nica':
                    #st.write("Negado")
                    st.image(image_button_neg, caption=None, output_format="JPEG")
    elif alteration_exam in ['N칚o possui', 'N칚o avaliado']:
        #st.write("Negado")
        st.image(image_button_neg, caption=None, output_format="JPEG")

if __name__ == "__main__":
    main()
